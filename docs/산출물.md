````markdown
# COPILOT 작업지시서 (단일 근거 문서)
문서명: `COPILOT_TASK.md`  
작성자: 위두소프트 전략기획/PM 관점  
목적: Teams ↔ Freshworks 양방향 채팅 브릿지(Bridge) 구축 건(개발비/기술지원비 2,000만원)에 대해 **납품 산출물 패키지(보고서/As-built/운영/Exit)**를 “증거 기반”으로 완성한다.  
주의: **추정/상상 금지**. Evidence에 없는 내용은 단정하지 말고 `[TBD]`로 표시한다.

---

## 0) 핵심 전제(이 프로젝트의 사실관계)
- Bot 구조는 **앱 등록(App Registration)과 Azure Bot Service 모두 위두소프트 테넌트(우리 Entra)에 구축**되어 있다.
- 고객 테넌트에는 **Teams 앱만 배포**되었으며, 고객 측 Entra에 별도의 App Registration/Bot 리소스는 없다.
- Bridge 백엔드는 **fly.io**에 운영된다.
- 대화/티켓 원본 저장소는 **Freshdesk**(또는 Freshworks 계열)이며, 보고서에는 이 사실을 명확히 적는다.
- 문서 톤은 **운영/리스크 감소/감사 대비** 중심이며, “계속 쓰세요” 같은 영업 멘트는 금지한다.

---

## 1) 산출물(Deliverables) — 반드시 아래 파일명으로 생성
아래 파일을 **각각 독립 Markdown 파일**로 작성해라. (한 파일에 몰아쓰지 말 것)

### [필수 6종]
1. `01_ExecutiveSummary.md`  
2. `02_AsBuilt_Architecture.md`  (Mermaid 다이어그램 포함)  
3. `03_Security_Operations_Controls.md`  
4. `04_Operations_Runbook.md`  
5. `05_Freshdesk_Export_Exit_Runbook.md`  
6. `Appendix_EvidencePack.md`

### [권장 2종]
7. `06_Release_Notes.md`  
8. `07_Acceptance_Signoff.md`

---

## 2) 입력 자료(Evidence Pack) — 아래 섹션에 붙여넣어진 텍스트만 근거로 사용
작성자는 아래에 CLI 출력/설정/코드 요약을 붙여넣을 것이다.  
너는 **이 Evidence만**으로 아키텍처/운영/Exit 문서를 작성해야 한다.

### 2.1 Azure / Entra / Bot (위두소프트 테넌트) — 붙여넣기 영역
아래에 사용자(대표)가 출력 텍스트를 붙여넣는다.

[PASTE_AZ_ACCOUNT_SHOW]

[PASTE_AZ_AD_APP_SHOW]

[PASTE_AZ_AD_APP_PERMISSION_LIST]

[PASTE_AZ_AD_SP_SHOW]  (있으면)

[PASTE_AZ_BOT_SHOW] or [PASTE_AZ_BOT_SHOW_MSBOT]

### 2.2 Fly.io (Bridge 백엔드) — 붙여넣기 영역
[PASTE_FLY_STATUS]

[PASTE_FLY_CONFIG_SHOW_TOML]

[PASTE_FLY_CONFIG_ENV]  (값이 노출되면 마스킹된 버전만)

[PASTE_FLY_SECRETS_LIST]  (이름만)

### 2.3 Freshdesk / Freshworks 운영 정보 — 붙여넣기 영역
[PASTE_FRESHDESK_INSTANCE_OWNERSHIP]  (고객 소유/우리 소유, 도메인/계정 범위 등)

[PASTE_DATA_RETENTION_POLICY]  (보관기간/접근권한/로그 범위)

[PASTE_SUPPORT_SCOPE_SLA]  (지원 시간/채널/대응 기준)

### 2.4 코드/레포(브릿지 로직) 핵심 정보 — 붙여넣기 영역
- 대표가 코드 일부 또는 핵심 모듈 설명을 붙여넣는다.
- 너는 여기에 적힌 로직만으로 메시지 흐름/에러처리/재시도/로깅을 서술해야 한다.

[PASTE_CODE_OVERVIEW]

---

## 3) 보안/비밀정보 처리 규칙(절대 준수)
- 아래 항목은 문서 어디에도 노출하지 않는다. 발견 즉시 `[REDACTED]` 처리:
  - 토큰, Client Secret, API Key, 인증서 원문, 비밀번호
  - 내부 URL의 query parameter, 서명값, webhook secret
  - 고객 개인정보/대화 본문 예시(필요 시 “형식”만 설명)
- ID 노출 정책:
  - Tenant ID / Client ID는 원칙적으로 문서에 적어도 되지만, 대표가 민감하다고 판단하면 일부 마스킹한다.  
    예) `xxxxxxxx-xxxx-xxxx-xxxx-****abcd`
- EvidencePack 부록에는 “원문”을 붙이지 말고, **마스킹된 출력만** 정리한다.

---

## 4) 작성 스타일/표현 규칙
- 언어: 한국어
- 어조: 내부 보고서/운영 문서(간결, 사실 중심)
- 금지: 과장/단정(“전사 표준”, “필수”), 영업 멘트(“계속 사용 권장”), 근거 없는 KPI 수치
- 불확실하면: `[TBD]` 표기 + “확인이 필요한 항목” 섹션에 모아둘 것
- 문서 구조는 표/체크리스트/짧은 문단 중심으로 가독성 우선

---

## 5) 문서별 상세 요구사항(Definition of Done)

### 5.1 `01_ExecutiveSummary.md` (1페이지)
반드시 포함:
- 목적/배경: (메일 시스템 오픈 등으로 발생한 대량 문의 대응)
- 적용 범위: 대상 부서/채널/기간
- 구현 요약: Teams ↔ Bridge ↔ Freshworks (+ Bot)
- 성과: 정성 + (Evidence에 있는 정량 KPI만) 2~3개
- 운영 현황: 안정화 여부, 남은 리스크/제약
- 다음 단계: (1) 유지(현행 범위) (2) 옵션(추가요청 시 CR) 형태로 제시

형식 예시:
- 한 페이지 분량(약 400~700자 + 표 1개 정도)로 압축

---

### 5.2 `02_AsBuilt_Architecture.md` (1~2페이지 + Mermaid 2개)
반드시 포함:
- 구성요소(소유 주체 포함): 위두소프트 테넌트(Entra App/Bot), fly.io(Bridge), Freshdesk(저장)
- 고객 테넌트에는 “Teams 앱 배포만 존재”를 명확히 기술
- 데이터 흐름 단계(1~6 단계)로 설명
- Mermaid 다이어그램 2개:
  1) 전체 아키텍처 다이어그램
  2) 메시지 시퀀스(사용자 메시지 → 티켓/대화 저장 → 상담원 응답 → Teams 전달)

Mermaid 예시(형식만 참고, 실제 내용은 Evidence에 맞춰 작성):
```mermaid
flowchart LR
  U[User in Teams] --> T[Teams App (Customer Tenant)]
  T --> B[Bridge on Fly.io (WeDoSoft)]
  B --> F[Freshdesk (System of Record)]
  B --> Bot[Azure Bot Service (WeDoSoft Tenant)]
  Bot --> B
  F --> B
  B --> T
````

---

### 5.3 `03_Security_Operations_Controls.md` (1페이지)

반드시 포함:

* 데이터 처리 위치/저장 위치(Freshdesk) 명시
* 접근통제: fly.io 접근, Azure 접근, 운영자 최소화
* 로그/감사: Bridge 로그 범위와 보관기간(있으면), 열람 권한
* 키/시크릿 관리: 문서 미기재 원칙, 만료/로테이션 계획(있으면)
* 중단(Exit) 통제 포인트(3단계 요약):

  * Teams 앱 배포 회수(고객) / Bridge 중지(우리) / Bot 비활성(우리) 등 Evidence에 맞춰 작성

---

### 5.4 `04_Operations_Runbook.md` (5~10페이지)

반드시 포함:

1. 정상 점검 체크리스트(매일/주간)
2. 장애 유형별 트러블슈팅 표(증상/원인/확인/조치)

   * Teams 측, Bridge 측(fly), Bot 측(Azure), Freshdesk 측으로 분류
3. 재기동/롤백 절차

   * fly.io 재기동(명령은 Evidence 또는 일반 절차로, 불명확하면 `[TBD]`)
4. 배포/변경 관리(릴리즈/핫픽스 프로세스)
5. 지원 범위/SLA(증거에 있는 범위만)
6. 연락체계(RACI) 초안

**중요:** 실제 명령/절차가 Evidence에 없으면 “추정 명령”을 넣지 말고 `[TBD]` 처리.

---

### 5.5 `05_Freshdesk_Export_Exit_Runbook.md` (운영용 절차서)

반드시 포함:

* 목적: 감사/전환 대비, “락인 방지” 관점
* Export 최소 세트:

  * 티켓 메타
  * 대화(conversations)
  * 첨부(선택/권장)
  * 활동 로그(가능 시)
  * KPI/리포트(가능 시)
* 폴더 구조/파일 네이밍/정기 백업 주기(권장: 월 1회 또는 이벤트 종료 시)
* 검증 절차:

  * 건수 검증, 무결성(해시) 검증, 샘플 복원 테스트
* Exit(중단) 절차:

  * “중단 순서”와 “중단 후 검증”을 반드시 포함
  * 고객 테넌트 리소스가 제한적이므로 “Teams 앱 배포 회수”가 핵심임을 반영

API 예시는 placeholder로 작성:

* 도메인/키/식별자: `[REDACTED]` 처리

---

### 5.6 `Appendix_EvidencePack.md`

반드시 포함:

* Evidence 목록(무엇을 근거로 썼는지)
* az/fly 출력의 요약(마스킹된 형태)
* 다이어그램/Runbook에서 참조한 키 포인트(예: 리전, 앱명, 포트, 헬스체크 유무 등)

---

### 5.7 `06_Release_Notes.md` (권장)

반드시 포함:

* 날짜별 변경(초기 PoC → 적용 → 핫픽스)
* 변경 내용/이유/영향/배포자/검증 결과
* 근거가 없으면 `[TBD]`

---

### 5.8 `07_Acceptance_Signoff.md` (권장, 감사 방어용)

반드시 포함:

* 납품 범위(문서 패키지 + 시스템 적용 범위)
* 지원 범위(기간/시간/채널)
* 검수 체크 항목(아키텍처/운영/Exit 문서 제공 여부 등)
* 서명란(고객 담당/위두소프트 담당/일자)

---

## 6) 산출 순서(권장 작업 플로우)

1. EvidencePack을 읽고 사실관계/불확실 항목을 분리
2. As-built 다이어그램(Architecture/Sequence)부터 생성
3. 그 내용을 기반으로 Executive Summary 작성
4. Security/Controls 1페이지 작성
5. Runbook 작성(정상/장애/중단)
6. Freshdesk Export/Exit 작성
7. 부록 EvidencePack 정리
8. (권장) Release Notes, Acceptance Signoff 작성

---

## 7) 최종 검수 체크(문서 완성 전 반드시 셀프체크)

* [ ] 민감정보(키/시크릿/토큰/대화 본문) 0건
* [ ] “우리 테넌트 소유”와 “고객 테넌트는 배포만” 경계가 명확
* [ ] 데이터 저장 위치(Freshdesk) 명확 + 브릿지 로그 범위 명확(불명확 시 `[TBD]`)
* [ ] 중단(Exit) 절차가 실제 수행 가능하도록 단계/검증 포함
* [ ] 근거 없는 KPI/과장 표현 없음
* [ ] Evidence에 없는 내용은 `[TBD]`로 표시 + “확인 필요” 섹션에 정리

---

## 8) Copilot 출력 형식(중요)

너는 **최종 응답에서 아래 형식으로 각 파일 내용을 출력**하라.

예시:

```
=== FILE: 01_ExecutiveSummary.md ===
(내용)

=== FILE: 02_AsBuilt_Architecture.md ===
(내용)
...
```

끝.

```
::contentReference[oaicite:0]{index=0}
```
